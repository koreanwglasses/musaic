var Musaic=function(t){var e={};function r(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=3)}([function(t,e){t.exports=THREE},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class n{constructor(t,e,r,n){this.r=void 0!==t?t:0,this.g=void 0!==e?e:0,this.b=void 0!==r?r:0,this.a=void 0!==n?n:1}getR(){return this.r}getG(){return this.g}getB(){return this.b}getA(){return this.a}getRgba(){return"rgba("+this.r+","+this.b+","+this.g+","+this.a+")"}equals(t){return t instanceof n&&(this.r==t.r&&this.g==t.g&&this.b==t.b&&this.a==t.a)}hashString(){return this.r+","+this.g+","+this.b+","+this.a}}n.blank=new n(0,0,0,0),e.Color=n;class i{constructor(t,e){this.x=t||0,this.y=e||0}getX(){return this.x}getY(){return this.y}equals(t){return t instanceof i&&(this.x==t.x&&this.y==t.y)}hashString(){return this.x+","+this.y}}e.Point=i;e.Pixel=class{constructor(t,e){this.position=t,this.color=e}getPosition(){return this.position}getColor(){return this.color}}},function(t,e){t.exports=React},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});let n=new(r(4).SimpleAnimationController);n.init(),n.start()},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=r(2),i=r(5),o=r(6),s=r(8),a=r(1);e.SimpleAnimationController=class{constructor(t,e){this.mosaic=void 0!==t?t:new s.SimpleMosaic(100,100),this.view=void 0!==e?e:n.createElement(o.VoronoiView,{mosaic:this.mosaic,scale:5})}init(){i.render(this.view,document.getElementById("root"))}start(){let t=this;!function e(){let r=function e(r){if(1==r){let e=Math.floor(255*Math.random()),r=Math.floor(255*Math.random()),n=Math.floor(255*Math.random()),i=new a.Color(e,r,n);return t.mosaic.addTile(i)}for(let t=0;t<r;t++)if(!e(1))return!1;return!0}(10);t.mosaic.notifyObservers(),r&&requestAnimationFrame(e)}()}}},function(t,e){t.exports=ReactDOM},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=r(2),i=r(0),o=r(1),s=r(7),a=r(0);e.VoronoiView=class extends n.Component{constructor(t){if(super(t),this.mosaic=this.props.mosaic,!this.mosaic)throw new Error("Mosaic not defined in props!");this.scale=this.props.scale||1,this.mosaic.addObserver(this)}componentDidMount(){this.init(),this.updateCanvas()}init(){const t=this.refs.container;this.renderer=new i.WebGLRenderer,this.renderer.setSize(this.mosaic.getWidth()*this.scale,this.mosaic.getHeight()*this.scale),t.appendChild(this.renderer.domElement),this.scene=new i.Scene,this.camera=new i.OrthographicCamera(0,this.mosaic.getWidth(),0,-this.mosaic.getHeight(),0,1e3),this.camera.position.y=10,this.camera.lookAt(0,0,0),this.offsets=new Array;for(let t=0;t<this.mosaic.getHeight();t++)this.offsets[t]=new Array}updateCanvas(){for(;this.scene.children.length>0;)this.scene.remove(this.scene.children[0]);let t=new Array;for(let e=0;e<this.mosaic.getHeight();e++)for(let r=0;r<this.mosaic.getWidth();r++){let n;if(!(n=this.mosaic.isOnBoundary(r,e)?new o.Color(0,0,0,1):this.mosaic.getColorAt(r,e)).equals(o.Color.blank)){let i=new o.Pixel(new o.Point(r,e),n);if(t.push(i),!this.offsets[e][r]){let t=.8*(Math.random()-.5),n=.8*(Math.random()-.5);this.offsets[e][r]=new a.Vector2(t,n)}}}let e=new s.VoronoiHelper(t,this.offsets,2);this.scene.add(e),this.renderer.render(this.scene,this.camera)}render(){return n.createElement("div",{ref:"container"})}update(){this.updateCanvas()}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=r(0);class i extends n.Object3D{constructor(t,e,r,o){super();for(var s=t.length,a=r||1,h=o||16,l=[],u=[],c=0;c<s;c++){let r=t[c].getPosition().getX(),n=t[c].getPosition().getY();l.push(r+e[n][r].x,0,n+e[n][r].y),u.push(t[c].getColor().getR()/255,t[c].getColor().getG()/255,t[c].getColor().getB()/255,1)}var d=new n.ConeBufferGeometry(a,2*a,h),f=new n.InstancedBufferGeometry;f.index=d.index,f.attributes=d.attributes,f.maxInstancedCount=s,f.addAttribute("offset",new n.InstancedBufferAttribute(new Float32Array(l),3)),f.addAttribute("color",new n.InstancedBufferAttribute(new Float32Array(u),4));var g=new n.RawShaderMaterial({vertexShader:i.vertexShader,fragmentShader:i.fragmentShader}),p=new n.Mesh(f,g);this.add(p)}}i.vertexShader="\n    precision highp float;\n    \n    uniform float sineTime;\n    \n    uniform mat4 modelViewMatrix;\n    uniform mat4 projectionMatrix;\n    \n    attribute vec3 position;\n    attribute vec3 offset;\n    attribute vec4 color;\n    \n    varying vec3 vPosition;\n    varying vec4 vColor;\n    \n    void main(){\n        vPosition = offset + position;\n        vColor = color;\n        gl_Position = projectionMatrix * modelViewMatrix * vec4( vPosition, 1.0 );\n    } \n    ",i.fragmentShader="\n    precision highp float;\n    \n    varying vec4 vColor;\n    \n    void main() {\n        gl_FragColor = vColor;\n    }\n    ",e.VoronoiHelper=i},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=r(1),i=r(9),o=r(10);e.SimpleMosaic=class extends o.Mosaic{constructor(t,e){super(t,e),this.grid=new Array;for(let r=0;r<e;r++){this.grid[r]=new Array;for(let e=0;e<t;e++)this.grid[r][e]=n.Color.blank}this.boundary=new i.HashSet,this.boundary.add(new n.Point(Math.floor(t/2),Math.floor(e/2)))}addTile(t){let e=this;function r(t,r){let i=new Array;return i.push(new n.Point(t-1,r-1)),i.push(new n.Point(t-1,r)),i.push(new n.Point(t-1,r+1)),i.push(new n.Point(t,r-1)),i.push(new n.Point(t,r+1)),i.push(new n.Point(t+1,r-1)),i.push(new n.Point(t+1,r)),i.push(new n.Point(t+1,r+1)),i.filter(t=>0<=t.getX()&&t.getX()<e.getWidth()&&0<=t.getY()&&t.getY()<e.getHeight())}function i(i,o){let s=r(i,o).filter(t=>!e.getColorAt(t.getX(),t.getY()).equals(n.Color.blank)).map(r=>(function(t,e){return Math.pow(t.getR()-e.getR(),2)+Math.pow(t.getG()-e.getG(),2)+Math.pow(t.getB()-e.getB(),2)})(t,e.getColorAt(r.getX(),r.getY())));return 0==s.length?0:Math.min(...s)}let o=function(){let t,r=Number.POSITIVE_INFINITY;for(let n of e.boundary){let e=i(n.getX(),n.getY());e<r&&(r=e,t=n)}return t}();return!!o&&(function(t){e.boundary.delete(t);let i=r(t.getX(),t.getY()).filter(t=>e.getColorAt(t.getX(),t.getY()).equals(n.Color.blank));e.boundary.addAll(i)}(o),this.grid[o.getY()][o.getX()]=t,this.setChanged(),!0)}getColorAt(t,e){return this.grid[e][t]}isOnBoundary(t,e){return this.boundary.has(new n.Point(t,e))}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.HashSet=class{constructor(t){if(this.map=new Map,t)for(let e of t)this.add(e)}add(t){if(!this.has(t)){let e=t.hashString(),r=this.map.get(e);r?r.push(t):this.map.set(e,[t])}return this}addAll(t){for(let e of t)this.add(e);return this}clear(){throw new Error("Method not implemented.")}delete(t){if(this.has(t)){let e=t.hashString(),r=this.map.get(e);1==r.length&&this.map.delete(e);let n=r.findIndex(e=>t.equals(e));return r.splice(n,1),!0}return!1}entries(){throw new Error("Method not implemented.")}forEach(t,e){throw new Error("Method not implemented.")}has(t){let e=this.map.get(t.hashString());if(e){if(1==e.length)return!0;for(let r of e)if(t.equals(r))return!0;return!1}return!1}keys(){return this.values()}values(){let t=new Array;for(let e of this.map)for(let r of e[1])t.push(r);return t.values()}[Symbol.iterator](){return this.values()}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=r(11);e.Mosaic=class extends n.Observable{constructor(t,e){super(),this.width=t,this.height=e}getWidth(){return this.width}getHeight(){return this.height}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.Observable=class{constructor(){this.observers=new Set}addObserver(t){this.observers.add(t)}hasChanged(){return this.isChanged}setChanged(){this.isChanged=!0}clearChanged(){this.isChanged=!1}notifyObservers(t){for(let e of this.observers)e.update(this,t);this.clearChanged()}}}]);