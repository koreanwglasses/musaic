var Musaic=function(t){var e={};function r(i){if(e[i])return e[i].exports;var s=e[i]={i:i,l:!1,exports:{}};return t[i].call(s.exports,s,s.exports,r),s.l=!0,s.exports}return r.m=t,r.c=e,r.d=function(t,e,i){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)r.d(i,s,function(e){return t[e]}.bind(null,s));return i},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=4)}([function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class i{constructor(t,e,r,i){this.r=void 0!==t?t:0,this.g=void 0!==e?e:0,this.b=void 0!==r?r:0,this.a=void 0!==i?i:1}getR(){return this.r}getG(){return this.g}getB(){return this.b}getA(){return this.a}getRgba(){return"rgba("+this.r+","+this.b+","+this.g+","+this.a+")"}equals(t){return t instanceof i&&(this.r==t.r&&this.g==t.g&&this.b==t.b&&this.a==t.a)}hashString(){return this.r+","+this.g+","+this.b+","+this.a}}i.blank=new i(0,0,0,0),e.Color=i;class s{constructor(t,e){this.x=t||0,this.y=e||0}getX(){return this.x}getY(){return this.y}equals(t){return t instanceof s&&(this.x==t.x&&this.y==t.y)}hashString(){return this.x+","+this.y}}e.Point=s;e.Pixel=class{constructor(t,e){this.position=t,this.color=e}getPosition(){return this.position}getColor(){return this.color}}},function(t,e){t.exports=THREE},function(t,e){t.exports=React},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.HashMap=class{constructor(t){if(this.map=new Map,t)for(let e of t)this.set(e[0],e[1])}clear(){this.map=new Map}delete(t){if(this.has(t)){let e=t.hashString(),r=this.map.get(e);1==r.length&&this.map.delete(e);let i=r.findIndex(e=>t.equals(e));return r.splice(i,1),!0}return!1}entries(){let t=new Array;for(let e of this.map)for(let r of e[1])t.push(r);return t.values()}forEach(t,e){throw new Error("Method not implemented.")}get(t){let e=this.map.get(t.hashString());if(e)for(let r of e)if(t.equals(r[0]))return r[1]}has(t){return void 0!==this.get(t)}keys(){let t=new Array;for(let e of this)t.push(e[0]);return t.values()}set(t,e){if(!this.has(t)){let r=t.hashString(),i=this.map.get(r);i?i.push([t,e]):this.map.set(r,[[t,e]])}return this}values(){let t=new Array;for(let e of this)t.push(e[1]);return t.values()}[Symbol.iterator](){return this.entries()}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});let i=new(r(5).SimpleAnimationController);i.init(),i.start()},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=r(2),s=r(6),n=r(7),o=r(9),a=r(0);e.SimpleAnimationController=class{constructor(t,e){this.mosaic=void 0!==t?t:new o.SimpleSquareMosaic(100,100),this.view=void 0!==e?e:i.createElement(n.VoronoiView,{mosaic:this.mosaic,scale:5})}init(){s.render(this.view,document.getElementById("root"))}start(){let t=this;!function e(){let r=function e(r){if(1==r){let e=Math.floor(255*Math.random()),r=Math.floor(255*Math.random()),i=Math.floor(255*Math.random()),s=new a.Color(e,r,i);return t.mosaic.addTile(s)}for(let t=0;t<r;t++)if(!e(1))return!1;return!0}(10);t.mosaic.notifyObservers(),r&&requestAnimationFrame(e)}()}}},function(t,e){t.exports=ReactDOM},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=r(2),s=r(1),n=r(0),o=r(8),a=r(1),h=r(3);e.VoronoiView=class extends i.Component{constructor(t){if(super(t),this.mosaic=this.props.mosaic,!this.mosaic)throw new Error("Mosaic not defined in props!");this.scale=this.props.scale||1,this.mosaic.addObserver(this)}componentDidMount(){this.init(),this.updateCanvas()}init(){const t=this.refs.container;this.renderer=new s.WebGLRenderer,this.renderer.setSize(this.mosaic.getWidth()*this.scale,this.mosaic.getHeight()*this.scale),t.appendChild(this.renderer.domElement),this.scene=new s.Scene,this.camera=new s.OrthographicCamera(0,this.mosaic.getWidth(),0,-this.mosaic.getHeight(),0,1e3),this.camera.position.y=10,this.camera.lookAt(0,0,0),this.offsets=new h.HashMap}updateCanvas(){for(;this.scene.children.length>0;)this.scene.remove(this.scene.children[0]);let t=new Array;for(let e of this.mosaic.allPoints()){let r,i=e.getX(),s=e.getY();if(r=this.mosaic.isOnBoundary(i,s)?new n.Color(0,0,0,1):this.mosaic.getColorAt(i,s),this.mosaic.isOnBoundary(i,s)||this.mosaic.isSet(i,s)){let i=new n.Pixel(e,r);if(t.push(i),!this.offsets.has(e)){let t=.8*(Math.random()-.5),r=.8*(Math.random()-.5);this.offsets.set(e,new a.Vector2(t,r))}}}let e=new o.VoronoiHelper(t,this.offsets,2);this.scene.add(e),this.renderer.render(this.scene,this.camera)}render(){return i.createElement("div",{ref:"container"})}update(){this.updateCanvas()}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=r(1);class s extends i.Object3D{constructor(t,e,r,n){super();for(var o=t.length,a=r||1,h=n||16,u=[],l=[],c=0;c<o;c++){let r=t[c].getPosition(),i=r.getX(),s=r.getY();u.push(i+e.get(r).x,0,s+e.get(r).y),l.push(t[c].getColor().getR()/255,t[c].getColor().getG()/255,t[c].getColor().getB()/255,1)}var d=new i.ConeBufferGeometry(a,2*a,h),f=new i.InstancedBufferGeometry;f.index=d.index,f.attributes=d.attributes,f.maxInstancedCount=o,f.addAttribute("offset",new i.InstancedBufferAttribute(new Float32Array(u),3)),f.addAttribute("color",new i.InstancedBufferAttribute(new Float32Array(l),4));var g=new i.RawShaderMaterial({vertexShader:s.vertexShader,fragmentShader:s.fragmentShader}),p=new i.Mesh(f,g);this.add(p)}}s.vertexShader="\n    precision highp float;\n    \n    uniform float sineTime;\n    \n    uniform mat4 modelViewMatrix;\n    uniform mat4 projectionMatrix;\n    \n    attribute vec3 position;\n    attribute vec3 offset;\n    attribute vec4 color;\n    \n    varying vec3 vPosition;\n    varying vec4 vColor;\n    \n    void main(){\n        vPosition = offset + position;\n        vColor = color;\n        gl_Position = projectionMatrix * modelViewMatrix * vec4( vPosition, 1.0 );\n    } \n    ",s.fragmentShader="\n    precision highp float;\n    \n    varying vec4 vColor;\n    \n    void main() {\n        gl_FragColor = vColor;\n    }\n    ",e.VoronoiHelper=s},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=r(10),s=r(14),n=r(0);e.SimpleSquareMosaic=class extends i.SimpleMosaic{constructor(t,e){super(new s.SquareGrid(t,e),[new n.Point(Math.floor(t/2),Math.floor(e/2))])}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=r(0),s=r(11),n=r(12);e.SimpleMosaic=class extends n.Mosaic{constructor(t,e){super(t.getWidth(),t.getHeight()),this.grid=t,this.boundary=new s.HashSet,this.boundary.addAll(e)}addTile(t){let e=this;function r(r,i){let s=e.grid.getNeighborsOf(r,i),n=Number.POSITIVE_INFINITY;for(let r of s)if(e.grid.isSet(r.getX(),r.getY())){let i=(o=t,a=e.grid.getColorAt(r.getX(),r.getY()),Math.pow(o.getR()-a.getR(),2)+Math.pow(o.getG()-a.getG(),2)+Math.pow(o.getB()-a.getB(),2));n=Math.min(n,i)}var o,a;return Number.isFinite(n)?n:0}let i=function(){let t,i=Number.POSITIVE_INFINITY;for(let s of e.boundary){let e=r(s.getX(),s.getY());e<i&&(i=e,t=s)}return t}();return!!i&&(function(t){e.boundary.delete(t);let r=e.grid.getNeighborsOf(t.getX(),t.getY());for(let t of r)e.grid.isSet(t.getX(),t.getY())||e.boundary.add(t)}(i),this.grid.setColorAt(i.getX(),i.getY(),t),this.setChanged(),!0)}getColorAt(t,e){return this.grid.getColorAt(t,e)}isSet(t,e){return this.grid.isSet(t,e)}isOnBoundary(t,e){return this.boundary.has(new i.Point(t,e))}allPoints(){return this.grid.getAllPoints()}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=r(3);e.HashSet=class{constructor(t){if(this.map=new i.HashMap,t)for(let e of t)this.add(e)}add(t){return this.map.set(t,t),this}addAll(t){for(let e of t)this.add(e);return this}clear(){this.map.clear()}delete(t){return this.map.delete(t)}entries(){return this.map.entries()}forEach(t,e){throw new Error("Method not implemented.")}has(t){return this.map.has(t)}keys(){return this.map.keys()}values(){return this.map.values()}[Symbol.iterator](){return this.values()}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=r(13);e.Mosaic=class extends i.Observable{constructor(t,e){super(),this.width=t,this.height=e}getWidth(){return this.width}getHeight(){return this.height}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.Observable=class{constructor(){this.observers=new Set}addObserver(t){this.observers.add(t)}hasChanged(){return this.isChanged}setChanged(){this.isChanged=!0}clearChanged(){this.isChanged=!1}notifyObservers(t){for(let e of this.observers)e.update(this,t);this.clearChanged()}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=r(0);e.SquareGrid=class{constructor(t,e){this.width=t,this.height=e,this.grid=new Array,this.allpts=new Array;for(let r=0;r<e;r++){this.grid[r]=new Array;for(let e=0;e<t;e++)this.grid[r][e]=i.Color.blank,this.allpts.push(new i.Point(e,r))}}setColorAt(t,e,r){this.grid[e][t]=r}getColorAt(t,e){return this.grid[e][t]}isSet(t,e){return!this.grid[e][t].equals(i.Color.blank)}getNeighborsOf(t,e){let r=new Array;r.push(new i.Point(t-1,e-1)),r.push(new i.Point(t-1,e)),r.push(new i.Point(t-1,e+1)),r.push(new i.Point(t,e-1)),r.push(new i.Point(t,e+1)),r.push(new i.Point(t+1,e-1)),r.push(new i.Point(t+1,e)),r.push(new i.Point(t+1,e+1));let s=this;return r.filter(t=>0<=t.getX()&&t.getX()<s.width&&0<=t.getY()&&t.getY()<s.height)}getAllPoints(){return this.allpts}getWidth(){return this.width}getHeight(){return this.height}}}]);